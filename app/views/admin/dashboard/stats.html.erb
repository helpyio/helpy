<% title "#{admin_title} #{t('team_insights', site_name: AppSettings['settings.site_name'])}" %>

<div class="team-header row">
  <div class="col-md-12 clearfix">
    <h2>
      <%= t('team_insights', site_name: AppSettings['settings.site_name']) %>
      <div class="dropdown pull-right">
        <button class="btn btn-default dropdown-toggle less-important" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
          <%= @interval.sentence_case %>
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
          <li><%= link_to t("today", default: "Today"), admin_stats_path(label: 'today') %></li>
          <li><%= link_to t("yesterday", default: "Yesterday"), admin_stats_path(label: 'yesterday') %></li>
          <li><%= link_to t("this_week", default: "This Week"), admin_stats_path(label: 'this_week') %></li>
          <li><%= link_to t("last_week", default: "Last Week"), admin_stats_path(label: 'last_week') %></li>
          <li><%= link_to t("this_month", default: "This Month"), admin_stats_path(label: 'this_month') %></li>
          <li><%= link_to t("last_month", default: "Last Month"), admin_stats_path(label: 'last_month') %></li>

          <hr>

          <li>
            <%= form_tag admin_stats_path, class: 'form-horizontal dropdown-form', method: :get do %>
              <%= hidden_field_tag :label, 'interval' %>
              <div class="form-group">
                <%= label_tag 'Start:', nil, class: 'col-sm-2 control-label' %>
                <div class="col-sm-10">
                  <div class="input-group date">
                    <%= text_field_tag :start_date, nil, class: 'form-control' %>
                    <span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <%= label_tag 'End:', nil, class: 'col-sm-2 control-label' %>
                <div class="col-sm-10">
                  <div class="input-group date">
                    <%= text_field_tag :end_date, nil, class: 'form-control' %>
                    <span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                  <%= submit_tag 'Filter', class: 'btn btn-default' %>
                </div>
              </div>
            <% end %>
          </li>
        </ul>
      </div>
    </h2>
  </div>

  <div class="col-md-12" style="margin-top: 0;">
    <h2 style="margin-top: 0;">
    <small>
      <% if @topic_count > 0 %>
        <%= t('insights_blurb_one', count: @topic_count, period: h(@interval.sentence_case)).html_safe %>
        <%= t('insights_blurb_two', number_replied: @responded_topics.count, percentage_replied: number_to_percentage(@responded_topics.count.to_f / @topic_count.to_f * 100.00, precision: 1)).html_safe %>
        <%= t('insights_blurb_three', response_time: distance_of_time_in_words(@median_first_response_time)).html_safe if @responded_topics.count > 0 %>
      <% else %>
        <%= t('no_discussions', period: h(@interval)).html_safe %>
      <% end %>
    </small>
    </h2>
  </div>
</div>

<div class="team-members row">
  <% @agents.each do |agent| %>
    <%= render partial: 'agent_stats', object: agent, as: 'agent' %>
  <% end %>

  <div class="col-md-<%= @cols %> col-sm-<%= @cols %> text-center agent invite-cn">
    <div class="add-team-member">
      <%= link_to admin_invite_path do %>
        <i class='fa fa-user-plus'></i><br/>
        <%= t('add_more_agents', default: "Add more Agents") %>
      </div>
      <% end %>
    </div>
  </div>
</div>
